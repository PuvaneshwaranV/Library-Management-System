<div class="container-fluid ">
  <div class="d-flex flex-column mb-3">
    <div class="modal fade" id="borrow_modal" tabindex="-1" aria-labelledby="borrow_modal_label" aria-hidden="true" data-bs-backdrop="static">
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-body position-relative mx-3">
            <h3 class="modal-title" id="borrow_modal_label">
              <!-- <i class="fa-solid fa-database me-3"></i> -->
              <img src="../assets/borrow Primary.png" alt="borrow book" height="35" width="35">
              Borrow Book
            </h3>
            <button type="button" class="btn-close-custom position-absolute top-0 end-0 m-3" data-bs-dismiss="modal"
              aria-label="Close">
              <i class="fa-regular fa-circle-xmark"></i>
            </button>
            <hr class="border border-1 border-dark opacity-100" />

            <form id="borrow_form" class="mx-5 my-4" >
              <!-- Member ID -->
              <div class="mb-3">
                <input type="text" class="form-control" id="member_id" name="member_id" placeholder="Member Id" />
                <!-- <div id="member_id_error" class="text-danger small"></div> -->
              </div>

              <!-- Book fields container -->
              <div id="books_container">
                <div class="book-entry mb-3 border p-3 rounded position-relative">
                  <button type="button" class="btn btn-sm btn-danger position-absolute top-0 end-0 m-2 remove-book-btn"
                    style="display:none;">
                    ✖
                  </button>
                  <input type="text" class="form-control mb-1" placeholder="Book Id" name="book_id[]" />
                  <!-- <div class="text-danger small error_book_id"></div> -->

                  <input type="number" class="form-control mb-1" placeholder="Quantity" name="quantity[]" />
                  <!-- <div class="text-danger small error_quantity"></div> -->
                  <div class="input-group  mb-1">
                    <input type="text" class="form-control due_date border-1 border-black border-end-0"
                      placeholder="YYYY-MM-DD" name="due_date[]" />
                    <span class="input-group-text border-1 border-black border-start-0"><i
                        class="fa fa-calendar due_date_calendar_icon"
                        style="color: #1e3a8a; cursor: pointer"></i></span>
                  </div>
                  <!-- <div class="text-danger small error_due_date"></div> -->
                </div>
              </div>

              <!-- Add another book button -->
              <button id="add_book_btn" type="button" class="btn btn-warning text-white w-100 mb-3">
                + Add Another Book
              </button>

              <div class="row">
                <div class="col-6">
                  <button id="cancel" type="button" class="btn btn-secondary w-100">
                    Reset
                  </button>
                </div>
                <div class="col-6">
                  <button id="add_btn" type="button" class="btn btn-dark w-100">
                    Save
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="update_rental_modal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static">
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-body position-relative mx-3">
            <h3 class="modal-title">
              <!-- <i class="fa-solid fa-pen-to-square me-3"></i> -->
               <img src="../assets/return book modal.png" alt="return book" height="35" width="35">
              Update Rental
            </h3>
            <button type="button" class="btn-close-custom position-absolute top-0 end-0 m-3" data-bs-dismiss="modal"
              aria-label="Close">
              <i class="fa-regular fa-circle-xmark"></i>
            </button>
            <hr class="border border-1 border-dark opacity-100" />

            <form class="mx-5 my-4">
              <div class="mb-3">
                <input type="text" class="form-control" id="update_transactionId" placeholder="Transaction ID"
                  disabled />
              </div>
              <div class="mb-3">
                <input type="text" class="form-control" id="update_bookId" placeholder="Book ID" disabled />
              </div>
              <div class="mb-3">
                <input type="number" class="form-control" id="update_quantity" placeholder="Quantity" min="1" />
              </div>
              <div class="row">
                <div class="col-6">
                  <button type="button" class="btn btn-secondary w-100" data-bs-dismiss="modal">Cancel</button>
                </div>
                <div class="col-6">
                  <button id="update_rental_btn" type="button" class="btn btn-dark w-100">Update</button>
                </div>
              </div>
            </form>

          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="return_modal" tabindex="-1" aria-labelledby="return_modal_label" aria-hidden="true" data-bs-backdrop="static">
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">

          <div class="modal-body position-relative mx-3">
            <h3 class="modal-title" id="return_modal_label">
              <!-- <i class="fa-solid fa-database me-3"></i> -->
               <img src="../assets/return book modal.png" alt="return book" height="35" width="35">
              Return Book
            </h3>
            <button type="button" class="btn-close-custom position-absolute top-0 end-0 m-3" data-bs-dismiss="modal"
              aria-label="Close">
              <i class="fa-regular fa-circle-xmark"></i>
            </button>
            <hr class="border border-1 border-dark opacity-100" />
            <form id="return_form" class="mx-5 my-4" >
              <div id="book_groups">
                <div class="book-group border rounded p-3 mb-3 position-relative">
                  <div class="mb-2">
                    <input type="text" class="form-control book-id" placeholder="Book ID" name="book-id[]" />
                   
                  </div>
                  <div class="mb-2">
                    <input type="number" class="form-control quantity" placeholder="Quantity" name="quantity[]" />
                 
                  </div>
                  <div class="mb-2">
                    <input type="text" class="form-control transaction-id" placeholder="Transaction ID" name="transaction-id[]" />
                 
                  </div>

                  <button type="button" class="btn btn-danger btn-sm remove-group position-absolute top-0 end-0 m-2"
                    style="display:none;">
                    <i class="fa-solid fa-trash"></i>
                  </button>
                </div>
              </div>

              <!-- Add new group button -->
              <button type="button" id="add_group" class="btn btn-warning text-white w-100 mb-3">
                + Add Book
              </button>

              <div class="row">
                <div class="col-6">
                  <button id="return_cancel" type="button" data-bs-dismiss="modal" class="btn btn-secondary w-100">
                    Cancel
                  </button>
                </div>
                <div class="col-6">
                  <button id="return_btn" type="button" class="btn btn-dark w-100">Return</button>
                </div>
              </div>
            </form>


          </div>

        </div>
      </div>
    </div>
    <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-3">

      <!-- Filters (left) -->
      <div id="rental_filters" class="d-flex gap-2 flex-wrap">
        <div class="d-flex flex-column">
          <label for="rental_length" class="ms-2 text-secondary">Show</label>
          <select id="rental_length" class="form-select filters text-secondary w-auto">
            <option value="10">10</option>
            <option value="25">25</option>
            <option value="50">50</option>
            <option value="100">100</option>
          </select>
        </div>
        <div class="d-flex flex-column">
          <label for="rental_status" class="ms-2 text-secondary">Status</label>
          <select id="rental_status" class="form-select filters text-secondary w-auto">
            <option value="all">All</option>
            <option value="returned">Returned</option>
            <option value="borrowed">Borrowed</option>
          </select>
        </div>
        <div class="d-flex flex-column">
          <label for="rental_filter_type" class="ms-2 text-secondary">Search By</label>
          <select id="rental_filter_type" class="form-select filters text-secondary w-auto">
            <option value="all">All</option>
            <option value="transactionId">Transaction Id</option>
            <option value="memberId">Member Id</option>
          </select>
        </div>
        <div class="d-flex flex-column">
          <label for="rental_filter_value" class="ms-2 text-secondary">Enter Value</label>
          <input type="text" id="rental_filter_value" class="form-control text-secondary filters w-auto"
                 placeholder="🔍 Enter Value" disabled />
        </div>
      </div>

      <!-- Borrow / Return Buttons (right) -->
      <div class="d-flex gap-2">
        <button class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#borrow_modal">
          <!-- <i class="fa-solid fa-circle-plus fa-lg me-1"></i> -->
           <img src="../assets/borrow.png" alt="borrow book" height="25" width="25">
          Borrow
        </button>
        <button class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#return_modal">
          <!-- <i class="fa-solid fa-circle-minus fa-lg me-1"></i> -->
           <img src="../assets/return.png" alt="return book" height="22" width="22" >
          Return
        </button>
        
      </div>

    </div>
    <!-- ✅ End single row -->

    <div class="d-flex justify-content-end gap-2">
      <button id="reset_rental_filters" class="btn btn-secondary">Reset</button>
      <button id="apply_rental_filters" class="btn btn-dark">Submit</button>
    </div>
    <div class="d-flex justify-content-end mt-2">
      <h6 class="text-warning"  style="display:none;font-weight:500;" id="lm_filter_changed">⚠️ Filter Condition changed. Please Click Submit.</h6>
    </div>
  </div>

  <div id="loader">
    <div class="circle-loader"></div>
  </div>

  <table id="user_table" class="display" style="width: 100%; display: none">
    <thead></thead>
    <tbody></tbody>
  </table>
</div>
